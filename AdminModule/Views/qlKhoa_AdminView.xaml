<UserControl 
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:AdminModule.Views" 
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:cv="clr-namespace:AdminModule.Models"
             xmlns:bt="clr-namespace:Resource.ButtonNew;assembly=Resource"
             xmlns:newcontrol="clr-namespace:Resource.NewControl;assembly=Resource"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:model="clr-namespace:AdminModule.Models"        
             xmlns:res="clr-namespace:Resource.AssemblySource;assembly=Resource"
             xmlns:Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero2" x:Class="AdminModule.Views.qlKhoa_AdminView"
             mc:Ignorable="d"
             Focusable="False" FocusVisualStyle="{x:Null}"
             x:Name="khoa"
             RenderOptions.ClearTypeHint="Enabled"
             prism:ViewModelLocator.AutoWireViewModel="True"
             Foreground="{DynamicResource {x:Static res:ColorASB.BD700}}"
             FontFamily="{DynamicResource {x:Static res:FontASB.Regular}}" 
             Background="White" MouseDown="UserControl_MouseDown"
             d:DesignHeight="562" d:DesignWidth="770">
    <UserControl.InputBindings>
        <KeyBinding Command="{Binding AddKhoaCommand}" Key="N" Modifiers="Ctrl"/>
    
    </UserControl.InputBindings>
    
    <UserControl.Resources>
        <model:BindingProxy 
  x:Key="DataContextProxy"
  Data="{Binding}" />


        <cv:Chuyendoislbanghi x:Key="chuyendoislbanghi"/>

        <Style x:Key="FocusVisual">
            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate>
                        <Rectangle StrokeDashArray="1 2" StrokeThickness="1" Stroke="{DynamicResource {x:Static SystemColors.ControlTextBrushKey}}" SnapsToDevicePixels="true" Margin="2"/>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>


    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="3*"/>
        </Grid.RowDefinitions>
        <Grid>

            <TextBlock HorizontalAlignment="Left" VerticalAlignment="Top" Margin="16" FontSize="24" FontFamily="{DynamicResource {x:Static res:FontASB.Medium}}"><Run Text="Khoa"/><Run FontFamily="{DynamicResource {x:Static res:FontASB.Regular}}" TextOptions.TextRenderingMode="ClearType" FontSize="11" Text="{Binding Count, Converter={StaticResource chuyendoislbanghi}}"/></TextBlock>
            <StackPanel HorizontalAlignment="Left" Margin="16 8" VerticalAlignment="Bottom" Orientation="Horizontal" >


                <ComboBox ItemsSource="{Binding ITEMS}" SelectedItem="{Binding DieuKienTimKiem, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" HorizontalContentAlignment="Left" ItemContainerStyle="{DynamicResource {x:Static res:ComboboxASB.CMBITEM1}}" Width="80" Margin="0 0 8 0" Style="{DynamicResource {x:Static res:ComboboxASB.CMB1}}" >

                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="SelectionChanged">
                            <i:InvokeCommandAction Command="{Binding TimKiemKhoaCommand}" CommandParameter="{Binding Text, ElementName=tk}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>

                </ComboBox>
                <TextBox Text="{Binding GiaTriTimKiem,Mode=OneWayToSource,UpdateSourceTrigger=PropertyChanged,Delay=500}" VerticalContentAlignment="Center" x:Name="tk" Tag="Tìm kiếm" Width="210" Height="32" Style="{DynamicResource {x:Static res:TextBoxASB.TBTK}}">

                </TextBox>
            </StackPanel>



            <StackPanel Margin="16 8" HorizontalAlignment="Right" VerticalAlignment="Bottom">
                <bt:Button2 Command="{Binding AddKhoaCommand}" FontFamily="{DynamicResource {x:Static res:FontASB.Regular}}"  FontSize="15" 
                            Width="88" Color="White" BorderThickness="0.6" 
                            BorderBrush="{DynamicResource {x:Static res:ColorASB.BD400}}" Press="{DynamicResource {x:Static res:ColorASB.BD400}}" Hover="{DynamicResource {x:Static res:ColorASB.BD200}}" Background="{DynamicResource {x:Static res:ColorASB.BD300}}" Style="{DynamicResource {x:Static res:ButtonASB.Bt_Round}}" border_radius="5">
                    <StackPanel Orientation="Horizontal">
                        <Image  Width="20" Height="20" Source="/Resource;component/img/8674406_ic_fluent_add_regular_icon (1).png" />
                        <TextBlock Text="Thêm" Margin="2 2 0 0" FontSize="15"/>
                    </StackPanel>
                </bt:Button2>
            </StackPanel>

        </Grid>

        <newcontrol:DatagridNew2 
                                RowEditEnding="dgvKhoa_RowEditEnding"  SelectionChanged="dgvKhoa_SelectionChanged" x:Name="dgvKhoa" IsSynchronizedWithCurrentItem="True"  CanUserAddRows="False" 
                                 VerticalContentAlignment="Center" HorizontalContentAlignment="Center"  Margin="16 0 16 16" 
                                 ColumnHeaderStyle="{DynamicResource {x:Static res:DatagridASB.DGVHEADER}}"  
                                 AutoGenerateColumns="False"
                                 CellStyle="{DynamicResource {x:Static res:DatagridASB.DGVCELL}}"
                                 GridLinesVisibility="All" HorizontalGridLinesBrush="{DynamicResource {x:Static res:ColorASB.Grey400}}" 
                                 VerticalGridLinesBrush="{DynamicResource {x:Static res:ColorASB.Grey400}}" 
                                 ItemsSource="{Binding DsKhoa, IsAsync=True}" Style="{DynamicResource {x:Static res:DatagridASB.DGV1}}" Grid.Row="1" >


            <newcontrol:DatagridNew2.RowStyle>
                <Style BasedOn="{StaticResource {x:Static res:DatagridASB.DGVROW}}" TargetType="DataGridRow">
                    <Setter Property="ContextMenu">
                        <Setter.Value>
                            <ContextMenu DataContext="{Binding PlacementTarget,RelativeSource={RelativeSource Mode=Self}}"
                                         ItemContainerStyle="{DynamicResource {x:Static res:ContextMenuASB.MNITEM1}}" 
                                         Style="{DynamicResource {x:Static res:ContextMenuASB.MN1}}">
                                <MenuItem >
                                    <MenuItem.Header>
                                        <Grid>
                                            <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left">Thông tin</TextBlock>
                                            <TextBlock Foreground="{DynamicResource {x:Static res:ColorASB.NL700}}" VerticalAlignment="Center" HorizontalAlignment="Right">Ctrl+I</TextBlock>
                                        </Grid>
                                    </MenuItem.Header>
                                </MenuItem>
                                <MenuItem >
                                    <MenuItem.Header>
                                        <Grid>
                                            <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left">Sửa</TextBlock>
                                            <TextBlock Foreground="{DynamicResource {x:Static res:ColorASB.NL700}}" VerticalAlignment="Center" HorizontalAlignment="Right">Ctrl+F</TextBlock>
                                        </Grid>
                                    </MenuItem.Header>
                                </MenuItem>

                                <MenuItem Command="{Binding Data.RemoveKhoa,Source={StaticResource DataContextProxy}}">
                                    <MenuItem.Header>
                                        <Grid>
                                            <TextBlock VerticalAlignment="Center" HorizontalAlignment="Left">Xoá</TextBlock>
                                            <TextBlock Foreground="{DynamicResource {x:Static res:ColorASB.NL700}}" VerticalAlignment="Center" 
                                                       HorizontalAlignment="Right">Ctrl+D/Del</TextBlock>
                                        </Grid>
                                    </MenuItem.Header>
                                </MenuItem>
                            </ContextMenu>
                        </Setter.Value>
                    </Setter>
                </Style>
            </newcontrol:DatagridNew2.RowStyle>

            <newcontrol:DatagridNew2.Columns>

                <DataGridTextColumn IsReadOnly="True" Binding="{Binding STT}" MinWidth="90" Header="STT">

                </DataGridTextColumn>

                <DataGridTextColumn IsReadOnly="True" Binding="{Binding MaKhoa}" MinWidth="110" Header="MÃ KHOA">

                </DataGridTextColumn>

                <DataGridTextColumn  Binding="{Binding TenKhoa,Mode=TwoWay,UpdateSourceTrigger=PropertyChanged}"  MinWidth="200" Header="TÊN KHOA">
           
                </DataGridTextColumn>


                <DataGridTextColumn   Binding="{Binding NamBatDau}" MinWidth="180" CanUserSort="False" Header="NGÀY THÀNH LẬP">

                </DataGridTextColumn>


                <DataGridTextColumn  Binding="{Binding GhiChu}"  MinWidth="180"  Header="GHI CHÚ">

                </DataGridTextColumn>

                <DataGridTemplateColumn MinWidth="100" Header="Hành động">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Orientation="Horizontal">
                                <bt:Button2 Style="{DynamicResource {x:Static res:ButtonASB.Bt_Round}}" Background="Transparent" BorderThickness="0"  Hover="{DynamicResource {x:Static res:ColorASB.Grey400}}" Press="{DynamicResource {x:Static res:ColorASB.Grey300}}" Width="24" Height="24" border_radius="5">
                                    <Image Width="16" Height="16" Source="/Resource;component/img/8675035_ic_fluent_edit_regular_icon.png" />

                                </bt:Button2 >
                                <bt:Button2 Command="{Binding DataContext.RemoveKhoa,RelativeSource={RelativeSource Mode=FindAncestor,AncestorLevel=1,AncestorType=UserControl}}" Style="{DynamicResource {x:Static res:ButtonASB.Bt_Round}}" Background="Transparent" 
                                            BorderThickness="0"  
                                            Hover="{DynamicResource {x:Static res:ColorASB.Grey400}}" Press="{DynamicResource {x:Static res:ColorASB.Grey300}}" Margin="8 0 0 0" Width="24" Height="24" border_radius="5">
                                    <Image Width="16" Height="16" Source="/Resource;component/img/8674741_ic_fluent_delete_regular_icon.png" />

                                </bt:Button2>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>


            </newcontrol:DatagridNew2.Columns>
        </newcontrol:DatagridNew2>

    </Grid>
</UserControl>
